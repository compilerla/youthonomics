{{ cms:snippet:header }}
<div class="content-wrap">
  <div class="container-fluid" id="contact-hero">
    <section class="row">
      <header>
        <h1>Contact Us</h1>
        <h4 class="emphasis-copy">Get In touch with Youthonomics</h4>
      </header>
    </section>
  </div><!-- /.container-fluid#contact-hero -->
  <div class="main-content">
    <form class="contact-now" id="contact-page-form" action="" method="post">
      <div class="centerer">
        <div class="input-text-container">
          <input type="text" placeholder="First and Last Name" name="name" value="" required>
        </div>
        <div class="input input-text-container">
          <input type="text" placeholder="Email Address" name="email" value="" required>
        </div>
        <div class="input input-dropdown">
          <label for="country-list">Select Your Country</label>
          <span class="sublabel">If you do not see your country avaliable from the list please select 'Other'</span>
          <select class="country-list" name="country-list" required>
            <option value="">Select Country</option>
          </select>
        </div>
        <div class="hidden input input-text-container">
          <label for="country-name">Please add your country name</label>
          <input type="text" placeholder="Country Name" name="country-name" value="">
        </div>
        <div class="input input-text-area">
          <label for="message">Message</label>
          <textarea name="message" rows="8" cols="40" required></textarea>
        </div>
      </div>
      <div class="input-submit-container">
        <input class="btn outline-red" type="submit" name="contact" value="send">
      </div>
    </form>
  </div><!-- /.main-content -->
</div><!-- /.content-wrap -->

<script>
  var countriesData = {{ cms:helper:country_data }};
  var sanitizedCountryList = [];
  var sanitizedCountryIso = [];
  var comma = ',';

  function sanitizeCountries(data) {
    for (obj in data) {
      var country = data[obj];
      var countryName = country.country;
      var countryIso = country.country_iso;
      // alphebetize country list here
      sanitizedCountryList.push(countryName + ' - ' + countryIso);
    }
    sanitizedCountryList.sort();
  }

  function listCountries(data) {
    // alphebetize country list here
    sanitizeCountries(data);
    // add sanitized list to select dropdown
    for (var i = 0; i < sanitizedCountryList.length; i++) {
      var country = sanitizedCountryList[i];
      var letterCount = country.length;
      var countryIso = country.substring(letterCount - 3, letterCount);
      var countryName = country.slice(0, letterCount - 6);
      $('.country-list').append("<option value=" + countryIso + ">" + countryName + "</option>");
    }
    $('.country-list').append("<option value=\"other\">Other</option>");
  }

  function checkSelect(form, select) {
    var sel = document.forms[form].elements['country-list'];
    // value property of select list (from selected option)
    var val = sel.value;
    $('.country-list').change( function() {
      currentSelected = $(this).find(":selected").val();
      if (currentSelected === 'other') {
        $('input[name="country-name"]').prop('required',true);
        $('input[name="country-name"]').parent('.input-text-container').removeClass('hidden');
      } else {
        $('input[name="country-name"]').prop('required',false);
        $('input[name="country-name"]').parent('.input-text-container').addClass('hidden');
      }
    });
  }

  $(document).ready(function(){
    console.log(countriesData);
    listCountries(countriesData);
    checkSelect('contact-page-form', 'country-name');
  });
</script>
{{ cms:snippet:footer }}
